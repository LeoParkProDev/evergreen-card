# Google Analytics 4 (GA4) 설정 가이드

이 가이드는 Evergreen Link 프로젝트에 Google Analytics 4를 설정하는 방법을 단계별로 안내합니다.

## 📋 목차

1. [GA4 계정 생성](#1-ga4-계정-생성)
2. [측정 ID 받기](#2-측정-id-받기)
3. [프로젝트 환경변수 설정](#3-프로젝트-환경변수-설정)
4. [추적되는 데이터 확인](#4-추적되는-데이터-확인)
5. [MAU/DAU 확인 방법](#5-maudau-확인-방법)

---

## 1. GA4 계정 생성

### 단계 1-1: Google Analytics 접속
1. [Google Analytics](https://analytics.google.com/) 접속
2. Google 계정으로 로그인

### 단계 1-2: 새 속성 만들기
1. 좌측 하단의 **"관리"** (톱니바퀴 아이콘) 클릭
2. **"속성 만들기"** 버튼 클릭
3. 속성 이름 입력 (예: "Evergreen Link")
4. 시간대: **"대한민국"** 선택
5. 통화: **"KRW (₩)"** 선택
6. **"다음"** 클릭

### 단계 1-3: 비즈니스 정보 입력
1. 업종 카테고리 선택 (예: "비즈니스 및 산업용 기계")
2. 비즈니스 규모 선택
3. 목표 선택 (예: "고객 참여도 측정")
4. **"만들기"** 클릭
5. 약관 동의 후 완료

---

## 2. 측정 ID 받기

### 단계 2-1: 데이터 스트림 생성
1. 속성 생성 완료 후, **"데이터 스트림"** 섹션으로 이동
2. **"웹"** 선택
3. 웹사이트 URL 입력 (배포된 도메인 주소, 예: `https://yoursite.com`)
4. 스트림 이름 입력 (예: "Evergreen Link - Production")
5. **"스트림 만들기"** 클릭

### 단계 2-2: 측정 ID 복사
1. 생성된 데이터 스트림을 클릭
2. 화면 상단의 **"측정 ID"** 확인 (형식: `G-XXXXXXXXXX`)
3. 측정 ID를 복사 (클립보드에 저장)

![측정 ID 예시](https://developers.google.com/static/analytics/devguides/collection/ga4/images/measurement-id.png?hl=ko)

---

## 3. 프로젝트 환경변수 설정

### 단계 3-1: .env 파일 생성

프로젝트 루트 디렉토리에 `.env` 파일을 생성합니다:

```bash
# 프로젝트 루트에서 실행
cp .env.example .env
```

### 단계 3-2: 측정 ID 입력

`.env` 파일을 열고, 복사한 측정 ID를 입력합니다:

```env
VITE_GA_MEASUREMENT_ID=G-XXXXXXXXXX
```

**예시:**
```env
VITE_GA_MEASUREMENT_ID=G-ABC123XYZ
```

### 단계 3-3: 개발 서버 재시작

환경변수 변경사항을 적용하려면 개발 서버를 재시작해야 합니다:

```bash
npm run dev
```

---

## 4. 추적되는 데이터 확인

### 자동 추적 항목

✅ **페이지뷰 (Page Views)**
- 홈페이지 접속: `/`
- 개별 명함 페이지: `/:guid`
- 경로 변경 시 자동 추적

✅ **사용자 세션 (Sessions)**
- 첫 방문 시 고유 디바이스 ID 생성 (로컬스토리지 기반)
- 세션 시작 시간 추적

✅ **사용자 행동 (Events)**

| 이벤트 이름 | 설명 | 추적 데이터 |
|------------|------|------------|
| `view_business_card` | 명함 탭 조회 | customer_id |
| `view_catalog` | 카탈로그 탭 조회 | customer_id |
| `view_item` | 제품 상세 보기 | item_id, item_name, customer_id |
| `call_button_click` | 전화 걸기 클릭 | phone_number, customer_id |
| `email_button_click` | 이메일 클릭 | email_address, customer_id |
| `sms_button_click` | SMS 클릭 | phone_number, customer_id |
| `copy_address` | 주소 복사 클릭 | address, customer_id |
| `request_quote` | 견적 문의 클릭 | item_id, item_name, customer_id |
| `tab_switch` | 탭 전환 | from_tab, to_tab, customer_id |

### 실시간 데이터 확인

1. [Google Analytics](https://analytics.google.com/) 접속
2. 좌측 메뉴에서 **"보고서" > "실시간"** 클릭
3. 개발 서버에서 사이트를 열고 버튼 클릭
4. 실시간으로 이벤트가 나타나는지 확인

---

## 5. MAU/DAU 확인 방법

### 대시보드 설정

#### 방법 1: 기본 보고서 사용

1. **일일 활성 사용자 (DAU)**
   - **"보고서" > "실시간"** 또는 **"수명 주기" > "참여도" > "개요"**
   - "활성 사용자" 지표 확인
   - 기간: "어제" 또는 "오늘"

2. **월간 활성 사용자 (MAU)**
   - **"보고서" > "수명 주기" > "참여도" > "개요"**
   - 기간: "지난 28일" 또는 "지난 30일"
   - "활성 사용자" 지표 확인

#### 방법 2: 맞춤 보고서 생성

1. 좌측 메뉴에서 **"탐색"** 클릭
2. **"비어 있음"** 템플릿 선택
3. 측정기준 추가:
   - `날짜` (일별 DAU)
   - `주` (주별 WAU)
   - `월` (월별 MAU)
4. 측정항목 추가:
   - `활성 사용자`
   - `신규 사용자`
   - `총 사용자`
5. 저장 후 정기적으로 확인

### 고유 장비 추적 (Device ID)

현재 구현에서는 **로컬스토리지 기반 디바이스 ID**를 사용하여 고유 사용자를 구분합니다:

- 브라우저/장비별로 고유한 UUID 생성
- 쿠키 삭제 또는 시크릿 모드 사용 시 새로운 ID 생성
- GA4의 `Client ID`와 별도로 `device_id` 사용자 속성 설정

#### 디바이스별 사용자 확인

1. **"탐색" > "새 탐색 만들기"**
2. 측정기준: `디바이스 카테고리`, `운영체제`, `브라우저`
3. 측정항목: `활성 사용자`, `총 사용자`
4. 장비별 (모바일, 데스크톱, 태블릿) 사용자 분포 확인 가능

---

## 🔍 자주 묻는 질문 (FAQ)

### Q1: 데이터가 실시간으로 보이지 않아요
**A:** GA4는 처리 지연이 있을 수 있습니다. "실시간" 보고서는 몇 초 내에 반영되지만, "참여도" 등의 표준 보고서는 24-48시간 후 정확한 데이터를 보여줍니다.

### Q2: MAU/DAU를 매일 자동으로 확인하고 싶어요
**A:** GA4 보고서를 이메일로 예약할 수 있습니다:
1. 원하는 보고서 열기
2. 상단의 **"공유" 아이콘** 클릭
3. **"보고서 예약"** 선택
4. 빈도 설정 (일별, 주별, 월별)

### Q3: 개발 환경에서의 테스트 트래픽을 제외하고 싶어요
**A:**
1. GA4 관리 > 데이터 스트림 > 웹 스트림 선택
2. **"태그 설정 구성" > "설정" > "내부 트래픽 정의"**
3. IP 주소 범위 추가
4. 필터 만들기로 내부 트래픽 제외

### Q4: GDPR/쿠키 동의가 필요한가요?
**A:** 한국 사이트는 필수는 아니지만, EU 사용자가 있다면 쿠키 동의 배너 추가를 권장합니다. 현재 코드는 `anonymize_ip: true`로 IP 익명화를 활성화했습니다.

---

## 🎯 다음 단계

설정이 완료되었다면:

1. ✅ 실시간 보고서에서 이벤트 확인
2. ✅ 24-48시간 후 정확한 DAU/MAU 데이터 확인
3. ✅ 맞춤 대시보드 생성으로 주요 지표 모니터링
4. ✅ 월별 보고서 예약으로 자동 이메일 수신

---

## 📞 도움이 필요하신가요?

- [GA4 공식 문서](https://support.google.com/analytics/answer/10089681?hl=ko)
- [GA4 측정 ID 설정](https://support.google.com/analytics/answer/9539598?hl=ko)
- [react-ga4 GitHub](https://github.com/codler/react-ga4)
